<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta charset="utf-8">
<title>Git Styleguide - Front-End Enginnering</title>
<meta name="description" content="">
<meta name="author" content="">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1">
<link rel="stylesheet" href="../assets/css/bulma.min.css">
<link rel="stylesheet" href="../assets/css/app.css">
<!--[if lt IE 9]>
<script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.2/html5shiv.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->
<link rel="shortcut icon" href="">
</head>
<body dir="LTR">

<nav class="columns navbar">
  <div class="column logo is-3 is-offset-1">
    <a class="is-brand" href="../index.html">
      Front-End Enginnering
    </a>
  </div>
</nav>

<div class="columns content">
  <div class="column is-2-desktop is-3-widescreen is-hidden-touch">
  </div>
  <div class="column article-container is-11-tablet is-8-desktop is-6-widescreen">
    <div class="breadcrumb-area"><a href="../index.html" class="breadcrumb-item">Home</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../Tech/index.html" class="breadcrumb-item">Tech</a><span class="breadcrumb-delimiter"> &gt; </span><a href="../Tech/2018-03-17-my-git-styleguide.html" class="breadcrumb-item">Git Styleguide</a></div>
    <h1 class="article-title">Git Styleguide</h1>
    
  <p>作者：张新</p>


    <div class="article">
      <h2 id="git-通用规则">Git 通用规则 <a class="markdownIt-Anchor" href="#git-通用规则">#</a></h2>
<ul>
<li>只能在功能分支上开发</li>
<li>禁止直接推送代码到 maser 分支（设置为受保护分支），推荐使用合并请求（PR/MR）</li>
<li>在发起合并请求前，请更新你本地的 master 分支并且使用交互式 rebase 操作(eg. git rebase -i --autosquash master)，从而保证你本地的提交应用于所有历史提交的最顶端，而不会去创建合并提交</li>
<li>在发起合并请求前，必须确保你的功能分支可以成功构建，并且通过了所有的代码规则检查和测试</li>
<li>合并完成后，删除本地和对应的远程分支（Gitlab 或 Gitee 有选项可以自动完成）</li>
</ul>
<h2 id="git-分支命名规则">Git 分支命名规则 <a class="markdownIt-Anchor" href="#git-分支命名规则">#</a></h2>
<ul>
<li>功能分支使用 <strong>feature/名字-项目名-简短描述</strong></li>
<li>Bug 分支使用 <strong>fix/名字-项目名-简短描述</strong></li>
<li>发布分支使用 <strong>release-发布日期</strong>，如果有多个发布使用 _1 形式的尾数来标识 (eg. <strong>release-20180318</strong>)</li>
<li>Hotfix 分支 <strong>hotfix/日期-bug 标题</strong></li>
</ul>
<p>针对更加复杂的项目（如一个项目里面牵涉多个子项目），为了不影响发布，Git 分支原则如下：</p>
<ul>
<li>迭代开始时，针对每个子项目新建分支，如 feature/wms，feature/tms, feature/pms 等等</li>
<li>迭代过程中，功能分支一律合并入对应的子项目分支，不污染主分支</li>
<li>联调和冒烟结束后，提交到对应测试分支，如 test-wms, test-tms 等等</li>
<li>迭代结束时，如果子项目确定需要发布，则在发布前将对应子项目分支合并入 master 分支发布完成后（基于 master），基于 master 分支拉取发布分支</li>
</ul>
<h2 id="git-工作流">Git 工作流 <a class="markdownIt-Anchor" href="#git-工作流">#</a></h2>
<p>基于上面提到的 Git 通用规则和一些常用的分支命名规则，我们会采用功能分支策略 + 交互式 Rebase:</p>
<h3 id="针对一个新项目-在您的开发目录下初始化您的项目">针对一个新项目, 在您的开发目录下初始化您的项目 <a class="markdownIt-Anchor" href="#针对一个新项目-在您的开发目录下初始化您的项目">#</a></h3>
<pre class="hljs"><code>git <span class="hljs-built_in">clone</span> ssh://git@git.guoxiaomei.cn:2224/fee/supply_chain.git
<span class="hljs-built_in">cd</span> &lt;项目目录&gt;
</code></pre>
<p>如果是（已有项目）随后的功能开发/代码变动，这一步请忽略。</p>
<h3 id="检出checkout-一个新的功能或故障修复featurefix分支">检出（Checkout） 一个新的功能或故障修复（feature/fix）分支 <a class="markdownIt-Anchor" href="#检出checkout-一个新的功能或故障修复featurefix分支">#</a></h3>
<pre class="hljs"><code>git checkout -b &lt;分支名称&gt;
</code></pre>
<h3 id="新增一下代码变更">新增一下代码变更 <a class="markdownIt-Anchor" href="#新增一下代码变更">#</a></h3>
<pre class="hljs"><code>git add .
git commit -m <span class="hljs-string">'your commit message'</span>
</code></pre>
<p>Git 提交消息格式也需要满足规范要求，见下文。</p>
<h3 id="保持与远程的同步以便拿到最新变更">保持与远程的同步，以便拿到最新变更 <a class="markdownIt-Anchor" href="#保持与远程的同步以便拿到最新变更">#</a></h3>
<pre class="hljs"><code>git checkout master
git pull --rebase
</code></pre>
<blockquote>
<p>时刻保持与远程仓库的同步是一个好习惯，可以提前解决有可能的代码冲突。</p>
</blockquote>
<h3 id="切换至功能分支后通过交互式-rebase-从您的-master-分支中获取最新的代码提交以更新您的功能分支">切换至功能分支后，通过交互式 rebase 从您的 master 分支中获取最新的代码提交，以更新您的功能分支 <a class="markdownIt-Anchor" href="#切换至功能分支后通过交互式-rebase-从您的-master-分支中获取最新的代码提交以更新您的功能分支">#</a></h3>
<pre class="hljs"><code>git checkout &lt;your-feature-branch&gt;
git rebase -i --autosquash master
</code></pre>
<p>没有人会愿意看到单个功能分支中的功能开发就占据如此多的提交历史。某些第三方 Git 代码管理平台（如 企业级的 Gitlab）提供该功能，在代码合并会时会自动帮你完成。</p>
<h3 id="如果没有冲突请跳过此步骤如果您有冲突-就需要解决它们并且继续变基操作">如果没有冲突请跳过此步骤，如果您有冲突, 就需要解决它们并且继续变基操作 <a class="markdownIt-Anchor" href="#如果没有冲突请跳过此步骤如果您有冲突-就需要解决它们并且继续变基操作">#</a></h3>
<pre class="hljs"><code>git add &lt;file1&gt; &lt;file2&gt; ...
git rebase --<span class="hljs-built_in">continue</span>
</code></pre>
<h3 id="推送您的功能分支">推送您的（功能）分支。 <a class="markdownIt-Anchor" href="#推送您的功能分支">#</a></h3>
<pre class="hljs"><code>git push -f
</code></pre>
<p>当您进行变基操作时，您会改变功能分支的提交历史，那么您必须使用 <strong>-f</strong> 或 <strong>--force</strong> 才能数强制推送到远程功能分支。</p>
<h3 id="提交一个合并请求merge-request">提交一个合并请求（Merge Request） <a class="markdownIt-Anchor" href="#提交一个合并请求merge-request">#</a></h3>
<h3 id="合并请求会被负责代码审查的同事接受合并和关闭">合并请求会被负责代码审查的同事接受，合并和关闭 <a class="markdownIt-Anchor" href="#合并请求会被负责代码审查的同事接受合并和关闭">#</a></h3>
<h3 id="如果您完成了开发请记得删除您的本地分支">如果您完成了开发，请记得删除您的本地分支 <a class="markdownIt-Anchor" href="#如果您完成了开发请记得删除您的本地分支">#</a></h3>
<pre class="hljs"><code>git branch -D &lt;your-feature-branch&gt;
</code></pre>
<p>某些第三方 Git 代码管理平台（如 Github/Gitlab）在合并 PR/MR 时提供自动删除分支功能。</p>
<h2 id="git-提交消息格式">Git 提交消息格式 <a class="markdownIt-Anchor" href="#git-提交消息格式">#</a></h2>
<p>请移玉步至 <a href="https://chris.beams.io/posts/git-commit/">How to Write a Git Commit Message</a></p>
<p>TLDR:</p>
<ul>
<li>用一个空行来分隔开主题和正文</li>
<li>主题限制在 50 个字符内</li>
<li>主题行首字母开始</li>
<li>主题行不要以句号结尾</li>
<li>主题行使用祈使语气</li>
<li>正文的每行限制在 72 个字符内，超过部分折行显示</li>
<li>使用正文部分去解释 是什么 和 为什么 而不是 怎么做</li>
</ul>
<p>推荐二个值得参考的 Git 提交消息最佳实践：</p>
<ul>
<li><a href="https://udacity.github.io/git-styleguide/">Udacity Git Commit Message Style Guide</a></li>
<li><a href="https://github.com/angular/angular.js/blob/master/CONTRIBUTING.md#commit-message-format">AngluarJS Commit Message Format</a></li>
</ul>
<p>二者大同小异，完全满足上面这七大原则，都可以帮助团队统一 Git 提交消息格式，从而与他人协作更加方便。</p>
<blockquote>
<p>推荐使用 commitizen 来帮助团队规范化整个流程，与 npm scripts 配合自动化整个流程。</p>
</blockquote>
<h2 id="自动检测-git-提交消息格式">自动检测 Git 提交消息格式 <a class="markdownIt-Anchor" href="#自动检测-git-提交消息格式">#</a></h2>
<p>随着团队人员增多，我们需要一种工具能够自动化帮助我们检测 Git 提交消息格式是否满足规范要求。推荐使用 <a href="https://github.com/marionebl/commitlint">marionebl/commitlint</a> 来自动化 Lint Git 提交的消息格式，并且配合 <strong>prepush hook</strong> 一起使用。</p>
<h2 id="自动生成-changelog"><a href="https://github.com/conventional-changelog/conventional-changelog">自动生成 CHANGELOG</a> <a class="markdownIt-Anchor" href="#自动生成-changelog">#</a></h2>
<p>如果是库或是框架的开发，我们需要提供 <strong>CHANGELOG</strong>，以让团队内部和外部人员知道我们最近所做的更新，如修改的 Bugs，新增加的功能或是其它性能上的提升等等。</p>

      
    </div>
    <div  dir="ltr" class="level article-bar is-mobile">
      <div class="level-item has-text-centered">
        <a title="previous page" class="previouse-article-link" href="../Tech/2018-03-14-move-from-sb-to-code.html"><span class="icon icon-previous" data-icon="previous"></span><span class="link-content">&laquo; Previous</span></a>
      </div>
      <div class="level-item has-text-centered">
        <a title="font size" class="link-item link-item-size">
          <span class="icon icon-size" data-icon="size"></span>
        </a>
      </div>
      <div class="level-item has-text-centered">
        <a title="table of content" class="link-item link-item-toc">
          <span class="icon icon-toc" data-icon="toc"></span>
        </a>
      </div>
      <div class="level-item has-text-centered">
        <a title="top" href="#">
          <span class="icon icon-up" data-icon="up"></span>
          <span class="link-content">⤊ Top</span>
        </a>
      </div>
      <div class="level-item has-text-centered">
        <a title="next page" class="next-article-link" href="../Tech/Active/index.html"><span class="icon icon-next" data-icon="next"></span><span class="link-content">Next &raquo;</span></a>
      </div>
    </div>
  </div>
  <div class="column is-2-widescreen is-hidden">
  </div>
</div>

<div class="columns foot">
  <div class="column is-8 is-offset-1 license">
    <p>网站内容许可证：公共领域（public domain）</p>
  </div>
  <div class="column is-3 build-by">
    Build by <a href="https://github.com/ruanyf/loppo" target="_blank">Loppo</a> 0.4.4
  </div>
</div>

<div class="book-toc notification is-warning is-hidden">
  <h3>Table of chapters &nbsp;<span class="title-close"><a class="button is-danger"> Close </a></span></h3>
  <ul class="chapter-area"><li class="chapter-item "><a href="../Life/index.html">Life</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-expand" data-icon="expand"></span></a></li><ul class="chapter-level-1"><li class="chapter-item "><a href="../Life/2016-08-30-keys-to-have-health-relationship.html">作为一个开发者，如何去维系和增进健康的人际关系？</a></li><li class="chapter-item "><a href="../Life/2018-03-13-maintaining-a-healthy-work-life-balance.html">如何在工作和工作中找到一个健康的平衡呢？</a></li></ul><li class="chapter-item "><a href="../Tech/index.html">Tech</a>&nbsp;<a class="first-level-collapse"><span class="icon icon-collapse" data-icon="collapse"></span></a></li><ul class="chapter-level-1 chapter-level-1-current"><li class="chapter-item "><a href="../Tech/2017-09-01-checklist-job-offer.html">工作机会的检查清单</a></li><li class="chapter-item "><a href="../Tech/2017-11-03-front-end-development-process.html">前端开发流程</a></li><li class="chapter-item "><a href="../Tech/2018-03-14-move-from-sb-to-code.html">我为什么放弃 Sublime Text 而转向 VSC？</a></li><li class="chapter-item chapter-item-current"><a href="../Tech/2018-03-17-my-git-styleguide.html">Git Styleguide</a></li><li class="chapter-item "><a href="../Tech/Active/index.html">Active</a></li><ul class="chapter-level-2"><li class="chapter-item "><a href="../Tech/Active/2017-09-25-active-development-workflow.html">活跃网络前端开发流程</a></li><li class="chapter-item "><a href="../Tech/Active/2017-10-19-front-end-engineering-in-active.html">活跃网络的前端工程化实践之路</a></li><li class="chapter-item "><a href="../Tech/Active/2017-10-23-active-china-fee-hiring-process.html">Active China Front-End Engineer Hiring Process</a></li></ul><li class="chapter-item "><a href="../Tech/React/index.html">React</a></li><ul class="chapter-level-2"><li class="chapter-item "><a href="../Tech/React/2017-06-04-how-we-structure-react-redux-project-stucture.html">我们如何组织 React + Redux 项目结构</a></li><li class="chapter-item "><a href="../Tech/React/2017-09-08-the-simplicity-of-redux.html">Redux 的简单性</a></li><li class="chapter-item "><a href="../Tech/React/2017-09-18-how-do-we-implement-i18n-based-on-react.html">我们如何基于 React 实现 i18n</a></li></ul></ul></ul>
</div>

<div class="progress-indicator"></div>

<!-- SCRIPTS -->
<script>
  var LOPPO = {};
  LOPPO.current_path = 'Tech/2018-03-17-my-git-styleguide.md';
  LOPPO.relative_root_path = '../';
  LOPPO.article_toc = "<ul class=\"markdownIt-TOC\">\n<li><a href=\"#git-%E9%80%9A%E7%94%A8%E8%A7%84%E5%88%99\">Git 通用规则</a></li>\n<li><a href=\"#git-%E5%88%86%E6%94%AF%E5%91%BD%E5%90%8D%E8%A7%84%E5%88%99\">Git 分支命名规则</a></li>\n<li><a href=\"#git-%E5%B7%A5%E4%BD%9C%E6%B5%81\">Git 工作流</a>\n<ul>\n<li><a href=\"#%E9%92%88%E5%AF%B9%E4%B8%80%E4%B8%AA%E6%96%B0%E9%A1%B9%E7%9B%AE-%E5%9C%A8%E6%82%A8%E7%9A%84%E5%BC%80%E5%8F%91%E7%9B%AE%E5%BD%95%E4%B8%8B%E5%88%9D%E5%A7%8B%E5%8C%96%E6%82%A8%E7%9A%84%E9%A1%B9%E7%9B%AE\">针对一个新项目, 在您的开发目录下初始化您的项目</a></li>\n<li><a href=\"#%E6%A3%80%E5%87%BAcheckout-%E4%B8%80%E4%B8%AA%E6%96%B0%E7%9A%84%E5%8A%9F%E8%83%BD%E6%88%96%E6%95%85%E9%9A%9C%E4%BF%AE%E5%A4%8Dfeaturefix%E5%88%86%E6%94%AF\">检出（Checkout） 一个新的功能或故障修复（feature/fix）分支</a></li>\n<li><a href=\"#%E6%96%B0%E5%A2%9E%E4%B8%80%E4%B8%8B%E4%BB%A3%E7%A0%81%E5%8F%98%E6%9B%B4\">新增一下代码变更</a></li>\n<li><a href=\"#%E4%BF%9D%E6%8C%81%E4%B8%8E%E8%BF%9C%E7%A8%8B%E7%9A%84%E5%90%8C%E6%AD%A5%E4%BB%A5%E4%BE%BF%E6%8B%BF%E5%88%B0%E6%9C%80%E6%96%B0%E5%8F%98%E6%9B%B4\">保持与远程的同步，以便拿到最新变更</a></li>\n<li><a href=\"#%E5%88%87%E6%8D%A2%E8%87%B3%E5%8A%9F%E8%83%BD%E5%88%86%E6%94%AF%E5%90%8E%E9%80%9A%E8%BF%87%E4%BA%A4%E4%BA%92%E5%BC%8F-rebase-%E4%BB%8E%E6%82%A8%E7%9A%84-master-%E5%88%86%E6%94%AF%E4%B8%AD%E8%8E%B7%E5%8F%96%E6%9C%80%E6%96%B0%E7%9A%84%E4%BB%A3%E7%A0%81%E6%8F%90%E4%BA%A4%E4%BB%A5%E6%9B%B4%E6%96%B0%E6%82%A8%E7%9A%84%E5%8A%9F%E8%83%BD%E5%88%86%E6%94%AF\">切换至功能分支后，通过交互式 rebase 从您的 master 分支中获取最新的代码提交，以更新您的功能分支</a></li>\n<li><a href=\"#%E5%A6%82%E6%9E%9C%E6%B2%A1%E6%9C%89%E5%86%B2%E7%AA%81%E8%AF%B7%E8%B7%B3%E8%BF%87%E6%AD%A4%E6%AD%A5%E9%AA%A4%E5%A6%82%E6%9E%9C%E6%82%A8%E6%9C%89%E5%86%B2%E7%AA%81-%E5%B0%B1%E9%9C%80%E8%A6%81%E8%A7%A3%E5%86%B3%E5%AE%83%E4%BB%AC%E5%B9%B6%E4%B8%94%E7%BB%A7%E7%BB%AD%E5%8F%98%E5%9F%BA%E6%93%8D%E4%BD%9C\">如果没有冲突请跳过此步骤，如果您有冲突, 就需要解决它们并且继续变基操作</a></li>\n<li><a href=\"#%E6%8E%A8%E9%80%81%E6%82%A8%E7%9A%84%E5%8A%9F%E8%83%BD%E5%88%86%E6%94%AF\">推送您的（功能）分支。</a></li>\n<li><a href=\"#%E6%8F%90%E4%BA%A4%E4%B8%80%E4%B8%AA%E5%90%88%E5%B9%B6%E8%AF%B7%E6%B1%82merge-request\">提交一个合并请求（Merge Request）</a></li>\n<li><a href=\"#%E5%90%88%E5%B9%B6%E8%AF%B7%E6%B1%82%E4%BC%9A%E8%A2%AB%E8%B4%9F%E8%B4%A3%E4%BB%A3%E7%A0%81%E5%AE%A1%E6%9F%A5%E7%9A%84%E5%90%8C%E4%BA%8B%E6%8E%A5%E5%8F%97%E5%90%88%E5%B9%B6%E5%92%8C%E5%85%B3%E9%97%AD\">合并请求会被负责代码审查的同事接受，合并和关闭</a></li>\n<li><a href=\"#%E5%A6%82%E6%9E%9C%E6%82%A8%E5%AE%8C%E6%88%90%E4%BA%86%E5%BC%80%E5%8F%91%E8%AF%B7%E8%AE%B0%E5%BE%97%E5%88%A0%E9%99%A4%E6%82%A8%E7%9A%84%E6%9C%AC%E5%9C%B0%E5%88%86%E6%94%AF\">如果您完成了开发，请记得删除您的本地分支</a></li>\n</ul>\n</li>\n<li><a href=\"#git-%E6%8F%90%E4%BA%A4%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F\">Git 提交消息格式</a></li>\n<li><a href=\"#%E8%87%AA%E5%8A%A8%E6%A3%80%E6%B5%8B-git-%E6%8F%90%E4%BA%A4%E6%B6%88%E6%81%AF%E6%A0%BC%E5%BC%8F\">自动检测 Git 提交消息格式</a></li>\n<li><a href=\"#%E8%87%AA%E5%8A%A8%E7%94%9F%E6%88%90-changelog\">自动生成 CHANGELOG</a></li>\n</ul>\n";
</script>
<script src="../assets/js/app.js"></script>

<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?8abfc12836cb16954eaaccc965864e54";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
</script>
</body>
</html>

